---
next: prepare-slide-decks
nexttitle: Prepare great slide decks for presentations
title: Write excellent code examples - The Developer Advocacy Handbook
summary: Some tips and tricks how to write code examples that educate and entertain.
heroimage: https://developer-advocacy.com/images/back-to-basics.png
---

# 撰写优秀的代码示例

![带有代码示例的推特截图](images/back-to-basics.png){:height="898" width="1188"}

代码示例是使您的文章对开发人员更相关的东西。它们比对某个产品的数十页内容更有意义，更重要的是它们邀请人们使用您的产品。您甚至经常会发现自己看技术文章时直接滚动到第一个代码示例。

> **事实：** 类似Stack Overflow这样的平台的成功表明，将解释保持到最少并让代码尽可能地发挥作用是有意义的。但是这也有一个不幸的影响，许多开发人员不再关注代码的“why”，而是只关注“how”，将代码复制粘贴到自己的产品中。我称这些人为“全栈Overflow开发人员”。

## 用你的例子解决问题

我最讨厌的事情之一就是那些无用的“hello world”例子。相反，我的目标是提供能解决实际问题的代码。

> **事实：** “Hello World” 代码教人编写代码，但不能教人如何解决其中的问题。

好的代码示例应该回答“这个技术如何帮助我解决问题？”而不是“我该如何使用它？” “我该如何使用它？”这个问题应该由文档回答。代码示例应该让人们对使用该产品感到兴奋，并引诱他们深入文档中了解详细信息。

因此，不要一开始就自己阅读文档，而是先检查该工具能做什么，找到一个这种技术可以帮助解决的一直想解决的问题。然后使用产品解决它，并将你所做的作为代码示例进行解释。这也是检查产品文档的有效性的绝佳方式。如果作为开发人员代表遇到困难，并且找不到有效的文档，那么这很好。你可以写缺失文档来帮助产品。

## 展示一个实际例子

在代码示例中展示的其中一件事情是一个完整的实现。没有什么比通过单击链接或在表单中操作一些数据来查看其功能更具有说服力了。你告诉读者它可以工作是一回事，但读者能够自己尝试并看到结果是更有意义的。

> **提示：** 如果你解释的代码是一个更大界面的一部分，或处于防火墙后面或需要身份验证，则仍然可以通过录制屏幕演示来展示其工作原理。这些演示不太有冲击力，可以被视作“假的”，但总比没有好。

示例既要有效，还要美观流畅。许多示例不符合美学规律，甚至违反了许多可用性基本原则——不要留下不良的第一印象。

## 解释必要的环境

为了确保某些软件或应用程序能够正常工作，需要在您的设备上安装一些必要的环境。以下是一些常见的必需环境：

- Java：许多应用程序和游戏需要 Java 才能正常运行。
- .NET Framework：这是 Microsoft 开发的一个软件框架，许多应用程序需要它才能正常工作。
- Python：这是一种常见的编程语言，许多应用程序和脚本需要它才能正常运行。
- Node.js：这是一个 JavaScript 运行时环境，许多后端应用程序和脚本需要它来运行。
- Ruby：这是另一种常见的编程语言，一些应用程序和脚本需要它来运行。

在安装任何应用程序之前，请务必检查该程序需要哪些环境，并确保您的设备已安装所有必要的环境。

你需要避免的一件事是让人们对你的代码感到兴奋，但是不能在他们自己的环境中让代码工作。你可以通过以下几种方式解决这个问题：

* **编写防御性代码** -- 在尝试访问依赖项之前检查它们的状态。
* **检查在线和HTTP状态** -- 如果您的代码需要从Web服务中提取数据，请说明用户需要在线运行它。例如，我曾经遇到过一些JavaScript示例离线或未运行本地服务器时无法工作的投诉。显然，我没有解释清楚它需要在线数据，并且出于安全原因，JavaScript的某些功能仅在通过HTTPS访问时可用，而不是在文件系统上。
* **列出所需内容** -- 说明您的依赖关系是什么。例如，“需要Node和npm”或“在Microsoft Edge 85及更高版本中运行”。如果需要第三方依赖项，请找到一个好的教程，让您的读者安装它们，并链接到依赖项名称。
* **提供一个简单的测试脚本**，以检查正确的设置。（有关示例，请参见[GeoMaker的测试文件](http://github.com/codepo8/GeoMaker/blob/3d88e693698965b802539d2a467e05f1f67cff76/test.php)）。

* **提供一个开发者密钥用于演示** -- 但要明确告诉人们要实现你的代码他们需要一个自己的密钥。提供一个申请密钥的链接。

你无法预测人们在实现你的代码时会做错哪些事情，但这些是一些预防沮丧的好方法。这让我想到了代码示例的一个重要部分：允许复制和粘贴。

## 写出能够工作的复制粘贴代码

复制和粘贴可能是学习编程最常用的方法。你可以写文档到手指流血，但最大的用例是开发人员会检查一个代码示例，复制和粘贴它，稍微调整直到卡住，然后开始阅读文档。

> **事实:** 编写干净的复制和粘贴示例非常重要。您在代码中添加的任何不良编码习惯都将被复制并成为实际实现的一部分。

复制并粘贴不可用的示例不仅毫无用处，而且还会破坏您的声誉并且对实施者来说非常令人沮丧。确保涵盖以下要点：

* **链接所有资源** - 将图像、CSS 和脚本资源指向 Web 位置，而不是本地链接或相对链接。人们会复制代码并将其粘贴到本地项目中，而不会下载依赖项。 
* **提供完整脚本** - 人们会复制和粘贴脚本的一部分，并抱怨它们不起作用，而没有意识到其他部分缺失。 
* **验证和保护您的代码** - 复制和粘贴的代码需要卓越。确保您的代码与其他代码良好地配合，并且不会导致任何警告或错误。

## 提供示例下载

在您的示例中，为下载提供演示代码的zip文件应该是您要做的第一件事之一。您可以要求读者下载、解压缩并与您一起编写代码。这在屏幕录制和视频教程中非常有效。无论如何，它都可以在读者的脑海中留下您的文章，因为它们有一些在它们的硬盘驱动器上的东西来提醒他们。

提供压缩版本的演示代码可能会让人很麻烦，因为每次更改都意味着你必须重新打包演示文件。幸运的是，像 [GitHub](http://github.com) 这样的托管代码解决方案可以自动为您完成此工作。

## 撰写干净而巧妙的示例

我再次强调，**你所展示的代码示例应该是你所写过的最干净和最巧妙的代码**。展示一个快速而肮脏的解决方案来让人们开始并因创建最短代码而获得立即赞誉的诱惑是非常强的。但这是程序员用来互相印象的，而不是开发者倡导的方式。

你想展示如何使用你所提倡的产品编写出优质的解决方案，每一个捷径都会被复制并成为不写出优质代码的借口。这不是我们的目的。

相反，演示代码可以广告最佳开发实践并在上下文中展示它们而不是作为学术练习。展示使用模块模式保护作用域并巧妙使用闭包的JavaScript，可以让您对这些想法进行跨链接，并可能让一些开发人员将其作为编码习惯的一部分进行采纳。

## 构建代码生成器

一个很好的解决方案是添加代码生成器，允许实现者添加一些参数，按下按钮，即可获得他们想要的代码。这非常强大。

有一个危险就是有些人可能永远不会费心了解真正的实现技巧。另一方面，这些读者本来也不太可能这么做。无论如何，你会有更多人看这个产品。

## 托管代码和演示文稿

让人很容易被诱惑把自己的代码和演示放在个人服务器上，我自己也这么干了很多年。优点是你能掌控这个服务器，缺点是你需要自己维护这个服务器。但是你要花时间去推广，而不是当一名服务器管理员。

> **警告：** 我多年来一直在将我的服务器用作游乐场，当我看到它的状态时，这也是明显的痛点。我过去的一些代码最终成为了出色的攻击向量，有一次我的2006年的一个AJAX演示最终导致一个垃圾博客被安装在一个深藏的文件夹中。这也意味着Google封锁了我的域名，还有许多其他问题。

拥有一个游乐场服务器非常棒，但是对于查看你的代码的人来说，它也应该是明显的一个Scratchpad。那里的代码可能随时都会消失。因此，考虑使用一种更经过维护和控制的方式来发布你的演示示例和代码更有意义。

### 版本控制是你的朋友

我发现的第一件能让我少遇到很多麻烦的事便是将所有东西都用版本控制。Git 是一种常见的用法，但将你的产品存在 OneDrive 、Dropbox、Box、Google Drive 或其他文件夹中也是一个好主意。你总会搞砸，能够还原最终的一个改变就是一件很棒的事。

> **事实：** 事实证明，使用Git意味着您可以节省硬盘空间，因为您不需要创建名为“test123-safety-still-works”的Zip文件或每个文件夹都带有版本名称和日期的文件夹结构。

以往使用版本控制系统是令人畏惧的，但是由于Git以及诸如GitHub和Gitlab的托管解决方案的出现，事情变得更加容易。Git的另一个实际好处是你被迫对提交进行评论。因此，你创建了一份更改历史，你可以用来向潜在的维护者或你想要教育的人描述代码。

此外，拥有一个开源的托管平台，如 GitHub 个人资料，是一个很好的方式让人们找到你的代码示例和课程，为它们作出贡献并给你提供上下文反馈。在这样的平台上报告的问题比通过电子邮件或社交媒体平台收到的随机反馈要容易理解得多。不管你选择哪个平台，重要的是不要只依赖免费套餐，而要在平台上获得更好的服务体验。这些不算贵，而且你也不想在达到某个限制或平台更改时，让自己的代码变得无法访问。

> **提示：** 这是一个重要的要点。你选择的任何平台都应该是一个备份和让人们找到你的途径。你不应该把东西托管在你无法随时获取所有数据备份并将其移动到其他地方的地方。我们的市场一直在变化，所以请确保你不会依赖于可能很快消失并带走所有工作的资源。

> **事实：** 基于 Git 的代码共享平台在设计上是兼容的，这意味着它们可以互相兼容，这应该会让您感到安全。这些平台也被高度优化，以提供和交付代码，就像 YouTube 和类似服务针对媒体流媒体进行了优化一样。

在分享代码时，我最大的烦恼之一就是需要在教程和文档中提供可执行的代码和易读的代码。我花了几年的时间将代码进行修改，使其在博客平台和书籍中正确地显示出来。使用像这样的平台来托管你的示例，这一点根本不是问题。

### 自动托管

Automated Hosting refers to the process of automatically setting up and configuring hosting environments for applications, websites, and software programs. This process involves using software tools and platforms to create virtual servers, install necessary software dependencies, and manage resources such as storage and network bandwidth. Automated Hosting helps developers and businesses save time and improve efficiency by eliminating the need for manual server setup and configuration. It also provides scalability and flexibility, allowing hosting resources to be easily adjusted as application demands change.

代码托管平台不仅允许您存储代码并使其对其他人可访问。这些平台还具有内置的反馈机制，人们可以获取您的代码、复制它，并立即根据他们的需求进行更改。

对你来说，还有添加维基和文档的选项。更重要的是，这些平台不仅允许你托管代码，而且允许你执行代码。当然，这带来了一些限制。你几乎可以在任何一个平台上展示 HTML、CSS 和 JavaScript。服务器端的可执行代码比较难找到一个位置，但是有一些平台也允许完整应用程序托管和源代码共存。

大多数平台都会有一些静态站点生成工具，比如[Gatsby](https://www.gatsbyjs.com/)，[Jekyll](https://jekyllrb.com/)或类似的工具。如果您正在在线阅读本书，那就是我使用的工具。这里的文本是用Markdown编写的，我使用[Jekyll](https://pages.github.com/)和GitHub pages生成HTML。

### 代码沙盒

除了用于托管代码和产品的平台之外，还有可用的代码沙盒服务。这些服务允许您编写一个代码示例，并将其作为源代码和可执行文件与世界分享。这些平台既是编辑器，也是查看结果的地方，它们高度优化了这种用例。作为额外的奖励，它们还允许您将代码示例嵌入博客文章和文章中。

[JSFiddle](https://jsfiddle.net/) 是最早的，接着 [JSBin](https://jsbin.com/) 开始流行， [Codepen](https://codepen.io/) 是这个领域的另一个主要参与者。其中任意一个优秀的地方在于，它们不仅允许您编写基本的 Web 代码，还为您提供预编译器，因此您可以专注于向人们展示某种抽象的工作原理，而无需通过设置和自定义抽象库来告诉他们。当我在 Mozilla Web Docs 团队工作时，我们发现直接尝试代码的人是胜利者。

在培训期间，由于公司政策的原因，你可能会遇到一些无法在自己的计算机上安装软件的组员。但是，通过使用这些服务，你仍然可以进行课程，因为所有参加者只需要拥有浏览器和连接即可。

### 实时编程环境

许多这些平台还拥有演示和实时模式，让您可以与其他人实时开发，就像您可以使用 Office 365 和 Google Docs 协作编写文本一样。 [Code Sandbox]（https://codesandbox.io/），[Glitch]（https://glitch.com/）和其他许多平台都专注于此，并且 Codepen 和 JSBin 也升级了其功能集，以允许这种用例的使用。

在线编码环境非常适合向潜在的客户展示一些东西，并考虑预订您的研讨会或演示。他们还非常适合创建一个简单的用例，并与世界上任何一个团队解决问题。毫不奇怪，他们在面试期间也经常被使用。

### 代码展示

其中一些平台在围绕代码示例构建社区方面表现出色。例如，Codepen是一个寻找示例以用于演示和解释技术背后的宝库。然而要注明参考来源很重要。您也可以参与并展示您自己的酷炫项目，从而在这些平台上建立知名度。

通常这些示例都是使用最新技术开发的，对于作为开发者倡导者的你来说，它们是向潜在用户展示自己价值的好方法。而且，玩起来非常有趣。我在展示网站上找到了很多有趣的人，分享了很多信息，其中一些演示在优化我工作中使用的浏览器的渲染引擎方面起了关键作用。